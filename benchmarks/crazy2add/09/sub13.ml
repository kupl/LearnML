type crazy2 = NIL | ZERO of crazy2 | ONE of crazy2 | MONE of crazy2
exception Error of string
let rec crazy2add(a,b) = 
   let rec  crazy2adder e =
        match e with 
        |NIL, NIL, ZERO(NIL)-> NIL
	|NIL, NIL, ONE(NIL)-> ONE(NIL) 
	|NIL, NIL, MONE(NIL)->MONE(NIL)
	|ZERO(x), NIL, ZERO(NIL)->ZERO(crazy2adder(x,NIL,ZERO(NIL)))
	|ZERO(x), NIL, ONE(NIL)->ONE(crazy2adder(x,NIL,ZERO(NIL)))
        |ZERO(x), NIL, MONE(NIL)->MONE(crazy2adder(x,NIL,ZERO(NIL)))
        |NIL, ZERO(y), ZERO(NIL)->ZERO(crazy2adder(NIL,y,ZERO(NIL)))
	|NIL, ZERO(y), ONE(NIL)->ONE(crazy2adder(NIL,y,ZERO(NIL)))
	|NIL, ZERO(y), MONE(NIL)->MONE(crazy2adder(NIL,y,ZERO(NIL)))
	|ONE(x), NIL, ZERO(NIL)->ONE(crazy2adder(x,NIL,ZERO(NIL)))
	|ONE(x), NIL, ONE(NIL)->ZERO(crazy2adder(x,NIL,ONE(NIL)))
        |ONE(x), NIL, MONE(NIL)-> ZERO(crazy2adder(x,NIL,ZERO(NIL)))
	|NIL, ONE(y), ZERO(NIL)->ONE(crazy2adder(NIL,y,ZERO(NIL)))
	|NIL, ONE(y), ONE(NIL)-> ZERO(crazy2adder(NIL,y,ONE(NIL)))
        |NIL, ONE(y), MONE(NIL)->ZERO(crazy2adder(NIL,y,ZERO(NIL)))
	|MONE(x), NIL, ZERO(NIL)->MONE(crazy2adder(x,NIL,ZERO(NIL)))
	|MONE(x), NIL, ONE(NIL)->ZERO(crazy2adder(x,NIL,ZERO(NIL)))
        |MONE(x), NIL, MONE(NIL)->ZERO(crazy2adder(x,NIL,MONE(NIL)))
	|NIL, MONE(y), ZERO(NIL)->MONE(crazy2adder(NIL,y,ZERO(NIL)))
	|NIL, MONE(y), ONE(NIL)->ZERO(crazy2adder(NIL,y,ZERO(NIL)))
        |NIL, MONE(y), MONE(NIL)->ZERO(crazy2adder(NIL,y,MONE(NIL)))
	|ZERO(x), ZERO(y), ZERO(NIL)->ZERO(crazy2adder(x,y,ZERO(NIL)))
	|ZERO(x), ZERO(y), ONE(NIL)->ONE(crazy2adder(x,y,ZERO(NIL)))
        |ZERO(x), ZERO(y), MONE(NIL)->MONE(crazy2adder(x,y,ZERO(NIL)))
	|ZERO(x), ONE(y), ZERO(NIL)->ONE(crazy2adder(x,y,ZERO(NIL)))
	|ZERO(x), ONE(y), ONE(NIL)->ZERO(crazy2adder(x,y,ONE(NIL)))
        |ZERO(x), ONE(y), MONE(NIL)->ZERO(crazy2adder(x,y,ZERO(NIL)))
	|ONE(x), ZERO(y), ZERO(NIL)->ONE(crazy2adder(x,y,ZERO(NIL)))
	|ONE(x), ZERO(y), ONE(NIL)->ZERO(crazy2adder(x,y,ONE(NIL)))
        |ONE(x), ZERO(y), MONE(NIL)->ZERO(crazy2adder(x,y,ZERO(NIL)))
	|ZERO(x), MONE(y), ZERO(NIL)->MONE(crazy2adder(x,y,ZERO(NIL)))
	|ZERO(x), MONE(y), ONE(NIL)->ZERO(crazy2adder(x,y,ZERO(NIL)))
        |ZERO(x), MONE(y), MONE(NIL)->ZERO(crazy2adder(x,y,MONE(NIL)))
	|MONE(x), ZERO(y), ZERO(NIL)->MONE(crazy2adder(x,y,ZERO(NIL)))
	|MONE(x), ZERO(y), ONE(NIL)->ZERO(crazy2adder(x,y,ZERO(NIL)))
        |MONE(x), ZERO(y), MONE(NIL)->ZERO(crazy2adder(x,y,MONE(NIL)))
	|ONE(x), ONE(y), ZERO(NIL)->ZERO(crazy2adder(x,y,ONE(NIL)))
	|ONE(x), ONE(y), ONE(NIL)->ONE(crazy2adder(x,y,ONE(NIL)))
        |ONE(x), ONE(y), MONE(NIL)->ONE(crazy2adder(x,y,ZERO(NIL)))
	|ONE(x), MONE(y), ZERO(NIL)->ZERO(crazy2adder(x,y,ZERO(NIL)))
	|ONE(x), MONE(y), ONE(NIL)->ONE(crazy2adder(x,y,ZERO(NIL)))
        |ONE(x), MONE(y), MONE(NIL)->MONE(crazy2adder(x,y,ZERO(NIL)))
	|MONE(x), ONE(y), ZERO(NIL)->ZERO(crazy2adder(x,y,ZERO(NIL)))
	|MONE(x), ONE(y), ONE(NIL)->ONE(crazy2adder(x,y,ZERO(NIL)))
        |MONE(x), ONE(y), MONE(NIL)->MONE(crazy2adder(x,y,ZERO(NIL)))
	|MONE(x), MONE(y), ZERO(NIL)->ZERO(crazy2adder(x,y,MONE(NIL)))
	|MONE(x), MONE(y), ONE(NIL)->MONE(crazy2adder(x,y,ZERO(NIL)))
        |MONE(x), MONE(y), MONE(NIL)->MONE(crazy2adder(x,y,MONE(NIL)))
        |_ -> raise(Error "invalid arg")
    in
              crazy2adder(a,b,ZERO(NIL))
